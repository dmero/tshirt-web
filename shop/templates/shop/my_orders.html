{% extends 'shop/base.html' %}
{% load static %}

{% block title %}My Orders - T-Shirt Shop{% endblock %}

{% block content %}
<div class="container">
    <h1>My Orders</h1>
    
    {% if orders %}
        <div class="orders-list">
            {% for order in orders %}
            <div class="order-card">
                <div class="order-header">
                    <div class="order-info">
                        <h3>Order #{{ order.id }}</h3>
                        <p class="order-date">{{ order.created_at|date:"F d, Y" }}</p>
                        <span class="order-status status-{{ order.status }}" style="display: inline-block;">{{ order.get_status_display }}</span>
                    </div>
                    <div class="order-total">
                        <strong>${{ order.total_amount }}</strong>
                    </div>
                </div>
                
                <div class="order-items">
                    {% for item in order.items.all %}
                    <div class="order-item">
                        <div class="item-image">
                            {% if item.product.image %}
                                <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}">
                            {% else %}
                                <img src="{% static 'images/placeholder.jpg' %}" alt="{{ item.product.name }}">
                            {% endif %}
                        </div>
                        <div class="item-details">
                            <h4>{{ item.product.name }}</h4>
                            <p>Size: {{ item.size }}</p>
                            <p>Quantity: {{ item.quantity }}</p>
                            <p class="item-price">${{ item.price }} each</p>
                        </div>
                        <div class="item-total">
                            <strong>${{ item.get_total_price }}</strong>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                {% if order.status == 'shipped' or order.status == 'delivered' %}
                    {% if order.tracking_number %}
                    <div class="tracking-info">
                        <h4>ðŸ“¦ Tracking Information</h4>
                        <div class="tracking-details">
                            <p><strong>Tracking Number:</strong> 
                                <span class="tracking-number">{{ order.tracking_number }}</span>
                            </p>
                            {% if order.tracking_url %}
                            <a href="{{ order.tracking_url }}" target="_blank" class="btn-track">
                                Track Package
                            </a>
                            {% endif %}
                            {% if order.status == 'shipped' %}
                            <p class="delivery-estimate">
                                <i class="fas fa-clock"></i> Expected delivery: 3-5 business days
                            </p>
                            {% elif order.status == 'delivered' %}
                            <p class="delivery-complete">
                                <i class="fas fa-check-circle"></i> Delivered on {{ order.updated_at|date:"F d, Y" }}
                            </p>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                {% endif %}
                
                {% if order.shipping_address %}
                <div class="shipping-address">
                    <h4>Shipping Address:</h4>
                    <p>{{ order.shipping_address }}</p>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-orders">
            <i class="fas fa-shopping-bag"></i>
            <h2>No orders yet</h2>
            <p>You haven't placed any orders yet. Start shopping to see your orders here!</p>
            <a href="{% url 'shop:index' %}" class="btn-primary">Start Shopping</a>
        </div>
    {% endif %}
</div>
{% endblock %}